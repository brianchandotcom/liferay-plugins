<?xml version="1.0"?>

<custom-sql>
	<sql id="com.liferay.mentions.service.persistence.UserFinder.findBySocialRelationTypes">
		<![CDATA[
			SELECT DISTINCT
				User_.userId AS userId, User_.contactId AS contactId, User_.screenName AS screenName, User_.firstName AS firstName, User_.middleName AS middleName, User_.lastName AS lastName, User_.portraitId AS portraitId
			FROM
				User_
			INNER JOIN
				SocialRelation ON
					(SocialRelation.userId2 = User_.userId)
			WHERE
				(SocialRelation.userId1 = ?) AND
				[$SOCIAL_RELATION_TYPES$]
				(User_.userId != ?) AND
				((lower(User_.firstName) LIKE ?) OR
				(lower(User_.middleName) LIKE ?) OR
				(lower(User_.lastName) LIKE ?) OR
				(lower(User_.screenName) LIKE ?))
			ORDER BY
				User_.firstName ASC,
				User_.middleName ASC,
				User_.lastName ASC
		]]>
	</sql>
	<sql id="com.liferay.mentions.service.persistence.UserFinder.findByUsersGroups">
		<![CDATA[
			SELECT DISTINCT
				User_.userId AS userId, User_.contactId AS contactId, User_.screenName AS screenName, User_.firstName AS firstName, User_.middleName AS middleName, User_.lastName AS lastName, User_.portraitId AS portraitId
			FROM
				User_
			INNER JOIN
				Users_Groups ON
					(Users_Groups.userId = User_.userId)
			WHERE
				(Users_Groups.groupId IN
					(
						SELECT
							Users_Groups.groupId
						FROM
							Users_Groups [$USERS_GROUPS_JOIN$]
						WHERE
							(userId = ?) [$USERS_GROUPS_WHERE$]
					)
				) AND
				(User_.userId != ?) AND
				((lower(User_.firstName) LIKE ?) OR
				(lower(User_.middleName) LIKE ?) OR
				(lower(User_.lastName) LIKE ?) OR
				(lower(User_.screenName) LIKE ?))
			ORDER BY
				User_.firstName ASC,
				User_.middleName ASC,
				User_.lastName ASC
		]]>
	</sql>
</custom-sql>